
<!DOCTYPE html>
<html>
	
<style>
body {

	background-image: url('images/cool-background.png');
	background-attachment: fixed;
	color: #333;
}

</style>

	<head>
		<title>HackTheBox SneakyMailer Writeup </title>
		
		<!-- link to main stylesheet -->
		<link rel="stylesheet" type="css/main.css">
	</head>
	<body>
		<div class="container">
    		<div class="blurb">
        		<h1>HTB SneakyMailer </h1>
				<p> 	
				<img src="images/sneaky/sneaky-header.PNG" alt="sneaky" class="inline"/> <br/> <br/> <br/>
				
				We start out with our usual nmap scan -  <br/> <br/>
				<img src="images/sneaky/nmap.PNG" alt="nmap" class="inline"/> <br/> <br/> <br/>
					
				Initially we can see we have a couple web servers and an email server. I went to checkout the web server on port 80 and discovered a list of emails. 
				<br/> <br/> 
				<img src="images/sneaky/sneaky-corp-home-page.PNG" alt="emails" class="inline"/> <br/> <br/> <br/>
					
				I ran gobuster to see if we could pull out any additional domains or vhosts, and we find dev.sneakcorp.htb. <br/> <br/>
				<img src="images/sneaky/gob1.PNG" alt="emails" class="inline"/> <br/> <br/> <br/>
				<img src="images/sneaky/gob2.PNG" alt="emails" class="inline"/> <br/> <br/> <br/>
					
				Sadly it appeared to have the same info as the normal domain. I checked out the app on port 8080 next. <br/> <br/>
				<img src="images/sneaky/8080-app.PNG" alt="web app on port 8080" class="inline"/> <br/> <br/> <br/>
					
				The FTP server appeared to be a dead end since at this point as we don't have any creds and there is no guest access. <br/>
				Judging by the name of the box and the fact that we have an email list, I started thinking we have to phish a user. <br/> <br/>
					
				I opted to use a tool called swaks - <a href="https://github.com/jetmore/swaks">which you can checkout here</a> <br/> <br/>
				
				Our basic idea is just to get one of the users to click on our ip, and should be able to see the connection in nc and judge where to go from there. <br/>
				I sent out an email to everyone on the list we found earlier, with the simple contents of "Visit 8.8.8.8" where 8.8.8.8 would be my ip. I then opened <br/>
				up a netcat window to see what we get. <br/> <br/>
				<img src="images/sneaky/swaks.PNG" alt="swaks" class="inline"/> <br/> <br/> <br/>
					
				And sure enough in our netcat window we see an http connection attempt with the users creds.  <br/> <br/>
				<img src="images/sneaky/phished.PNG" alt="phished" class="inline"/> <br/> <br/> <br/>	
					
				After urldecoding the above password, we get <br/> <br/>
					
				<xmp>
				Username: 	paulbyrd@sneakymailer.htb
				Password:	^(#J@SkFv2[%KhIxKk(Ju`hqcHl<:Ht
				</xmp>
				
				This is not very realistic, in the real world the users would probably not click the link on an email like this in the first place, and the users <br/>
				computer wouldnt just autofill their creds on a http request to a brand new ip. Still this was a pretty cool example. <br/> <br/>
				
				However with our new email creds, we should now be able to setup an email client and read through pauls emails. I opted to setup Evolution,
				which you can setup with a simple  <br/>
				<xmp>
				apt-get install evolution
				</xmp> <br/> <br/>
					
				After installing I configured the client and pointed it at sneakcorp.htb, we are able to see 2 emails in pauls sent folder.<br/>
				The first is a set of credentials for the developer user <br/> <br/>
				<img src="images/sneaky/smtp-creds.PNG" alt="pauls emails" class="inline"/> <br/> <br/> <br/>
					
				And the 2nd gives us a piece of information, telling us that all of the packages in pypi are ran and tested by the low user. This may <br/>
				come in handy  if we need to pivot to the low user. <br/> <br/>
				<img src="images/sneaky/smtp-info.PNG" alt="pauls emails" class="inline"/> <br/> <br/> <br/>
					
				Our updated cred list is now -
				<xmp>
				Username: 	paulbyrd@sneakymailer.htb
				Password:	^(#J@SkFv2[%KhIxKk(Ju`hqcHl<:Ht
										
				Username: 	developer
				Password: 	m^AsY7vTKVT+dV1{WOU%@NaHkUAId3]C
				</xmp>
					
				
				
					
				
				
					
				
			
			  	</p>
    		</div><!-- /.blurb -->
		<div class="blurb">	
		</div><!-- /.container -->
		
	</body>
</html>
